(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{569:function(s,t,a){"use strict";a.r(t);var n=a(7),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"session之-httpsessionactivation"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#session之-httpsessionactivation"}},[s._v("#")]),s._v(" session之 HttpSessionActivation")]),s._v(" "),t("p",[s._v("内容介绍")]),s._v(" "),t("p",[s._v("一、HttpSessionActivation")]),s._v(" "),t("h3",{attrs:{id:"一、httpsessionactivation"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、httpsessionactivation"}},[s._v("#")]),s._v(" 一、HttpSessionActivation")]),s._v(" "),t("p",[s._v("注意：因为钝化和活化 session,其实就是使用序列化和反序列化技术把 session 从内存保存到硬盘,和把 session 从硬盘加载到内存。")]),s._v(" "),t("p",[s._v("这说明如果 Person 类没有实现serializable,接口，那么当 session 钝化时就不会钝化 Person,而是把 Person 从 session 中移除再钝化!这也说明 ession 活化后, session 中就不在有 Person 对象了。")]),s._v(" "),t("p",[s._v("示例步骤:")]),s._v(" "),t("p",[s._v("先不管H ttpSessionA.ctivationListener 监听器接口，先来配置 Tomcat钝化 session 的参数，把")]),s._v(" "),t("p",[s._v("下面配置文件放到tomcat\\conf\\catalina\\localhost目录下!文件名称为项目名称。")]),s._v(" "),t("p",[s._v("``")]),s._v(" "),t("p",[s._v("`"),t("code",[s._v('"')]),s._v("org.apache.catalina.session.PresistentManger"),t("code",[s._v('"')]),s._v('(maxIdl9swap="1"`')]),s._v(" "),t("p",[s._v("`"),t("code",[s._v('"')]),s._v('org.apache.catalina.session.FileStore"(directory="mysession")/>`')]),s._v(" "),t("p",[s._v("``")]),s._v(" "),t("p",[s._v("``")]),s._v(" "),t("p",[s._v("访问项目的 index.jsp 页面，这会使 Tomcat 创建 Session 对象，然后等待一分钟后，查看")]),s._v(" "),t("p",[s._v("Tomcat\\work\\Catalina\\localhost\\istenermysession.目录下是否会产生文件，如果产生了，说明钝化session 的配置成功了，可以开始下一步了。")]),s._v(" "),t("p",[s._v("要实现上述的例子，我们首先创建一个类。")]),s._v(" "),t("p",[s._v("然后输入以下代码：")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("cn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("itcast")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("javax"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("servlet"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("http"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpsessionActivationListener")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("javax"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("servlet"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("http"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpsessionEvent")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("implements")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpsessionActivationListener")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sessionwillPassivate")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpsessionEvent")]),s._v(" se"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\nsystem"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("println "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"``啊～我陪``session``去火星了，地球已经不安全了``!`` "')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sessionDidActivate")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpSessionEvent")]),s._v(" se"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\nsystem"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"啊～我和``session``一起重返地球了``! "')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("而 a.jsp 中也将24行更改为 new cn.itcast.User()。而b.jsp不做更改。")]),s._v(" "),t("p",[s._v("之后再重新启动以下服务器。打开网页输入 a.jsp 保存数据再输入 b.jsp 只能看见一个 usual 类的 toString 方法。")]),s._v(" "),t("p",[s._v("之后我们就会发现小 usual 并没有陪 session 一起钝化硬盘上，因为小usual已经死了。因为他已经添加到了 session 里面，而过了一分钟会显示“啊～我陪 session 去火星了，地球已经不安全了!”说明小 usua l已 经死了并不在硬盘上。就好比：session 和小 usual 一起上了去往火星的车而在临上车前，小usual却因为没有票而被赶下来了。而地球毁灭的时候，小 usual 因为没有上车而毁灭了。")]),s._v(" "),t("p",[s._v("而之后我们如果做一个访问的过程。Session 中的小 usual 并不会再出现。")]),s._v(" "),t("p",[s._v("而所谓的火星就是该文件家mysession。只有在此实现了序列化的接口，对象就无法到此。任何能被序列化的接口都必须满足一个前提就是实现序列化接口，而usual 并没有满足序列化接口，所以才“死掉了”。")]),s._v(" "),t("p",[s._v("我们可以根据以下操作来查看我刚刚的字符串类是否实现序列化接口，我们可以看出 string 类型是有的。而 usual 并不可以。")]),s._v(" "),t("p",[s._v("为了保证这一问题我们在第6行加上 java.io.Serializable。这回 usual 就可以跟着session 一起到硬盘之上。")]),s._v(" "),t("p",[s._v("在网站上输入 a.jsp 保存数据，b.jsp 输出。这时就会显示出，表示此事 usual 有了序列化借口。而此时接口的作用就是来监听我们的 usual 是否跟随 session 钝化和活化，并没有实际意义，只不过拿来理解而已。")])])}),[],!1,null,null,null);t.default=e.exports}}]);